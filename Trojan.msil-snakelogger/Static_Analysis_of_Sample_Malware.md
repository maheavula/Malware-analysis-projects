# Malware Analysis Project - Static Analysis

This repository is part of a series of exercises aimed at performing a comprehensive malware analysis. In this section, we focus on **Static Analysis**, covering tasks such as extracting strings, analyzing the Portable Executable (PE) header, inspecting imports and exports, and more.

---

## Table of Contents
- Exercise 1: Extracting Strings

- Exercise 2: Analyzing the PE Header

- Exercise 3: Gathering Footprints of Different Sections

- Exercise 4: Inspecting Imports and Exports

- Exercise 5: Viewing Embedded Resources

- Exercise 6: Hex Analysis



---

### Exercise 1: Extracting Strings

**Objective**: Extract and analyze strings from the malware sample to gather initial clues about its functionality.

#### Steps:
1. **Open the DIE Tool**: Launch the [Detect It Easy (DIE)](https://ntinfo.biz/) tool.
2. **Load the Malware Sample**: Drag and drop the malware file into the tool to analyze its strings.
3. **Identify Interesting Strings**: After analyzing the file, these strings were identified as noteworthy:

#### Findings:
- Network activity: 
  - `WebClient`, `DownloadData`, `GetDomain`
  - `http://104.194.143.39/vin/Tobea.pdf`
  - `www.digicert.com`
- File paths and execution:
  - `doc6.exe`, `130.0.6679.0`
- Cryptographic operations:
  - `FromBase64String`, `TripleDESCryptoServiceProvider`
- Certificates and timestamping:
  - `DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA`
  - `http://ocsp.digicert.com`
  
---

### Exercise 2: Analyzing the PE Header

**Objective**: Examine the Portable Executable (PE) header to understand the structure and metadata of the malware.

#### Steps:
1. **Open the Malware in Pestudio**: Load the malware sample into [Pestudio](https://www.winitor.com/).
2. **Analyze PE Sections**:
   - Review sections such as `.text`, `.data`, `.rdata` for insights into the malware's code and data.
   - Note the **entry point** where the program execution begins.
   - Check the **timestamp** to determine the compilation date.

#### Findings:
- **Entry Point**: 
  - Address: `00402DDE`
  - Offset: `0FDE`
  - Relative Address: `2DDE`
- **Compilation Timestamp**: `Mon Sep 09 14:40:24 2024`
- **Sections**: `.text`, `.rsrc`, `.reloc`
- **Entropy**: `4.40043` (indicating the file is not packed).

![sections img](https://github.com/user-attachments/assets/2dd6cd4c-c213-4312-bd4d-a6910f4cd7a3)


---

### Exercise 3: Gathering Footprints of Different Sections

**Objective**: Identify malware footprints using the footprint section in Pestudio.

#### Steps:
1. Open the footprint section of Pestudio and examine it for indicators of compromise or notable behaviors.
   
#### Findings:
- The analysis in Pestudio's footprint section revealed several signs of malicious activity, indicating the file may perform unauthorized actions.

![footprints img](https://github.com/user-attachments/assets/8835e827-5991-49a2-b79d-3da83748b755)


---

### Exercise 4: Inspecting Imports and Exports

**Objective**: Identify the functions the malware imports from system libraries and any exported functions.

#### Steps:
1. **Use Dependency Walker**: Open the malware sample in [Dependency Walker](https://www.dependencywalker.com/).
2. **Analyze Imported Functions**:
   - Examine which system libraries the malware depends on.
   - Look for network-related or cryptographic functions.
   - Identify any exported functions that might hint at specific capabilities.

#### Findings:
- The malware imports several functions related to **network communication** and **file manipulation**, including:
  - `DownloadData`, `WebClient`, `MemoryStream`
  - `CreateDecryptor`, `TripleDESCryptoServiceProvider`
- Cryptographic operations indicate encryption and decryption capabilities.
  
---

### Exercise 5: Viewing Embedded Resources

**Objective**: Examine resources embedded within the malware sample for unusual content.

#### Steps:
1. **Use Resource Hacker**: Open the malware sample in [Resource Hacker](http://www.angusj.com/resourcehacker/).
2. **Analyze Resource Types**:
   - Browse icons, dialogs, and string tables.
   - Look for any suspicious or manipulated resources.

#### Findings:
- **Icon**: The malware contains an icon resembling an `.xls` file but with no actual content.
- **Version Info**:
  - The version info lists **Google LLC** as the company, but this is likely forged.
  - Key entries in the version information include:
    ```plaintext
    FileDescription: Google Updater
    FileVersion: 130.0.6679.0
    ProductName: Google Updater
    OriginalFilename: doc6.exe
    ```
- **Manifest**:
    ```xml
    <assemblyIdentity version="1.0.0.0" name="MyApplication.app"/>
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
        <security>
            <requestedPrivileges>
                <requestedExecutionLevel level="asInvoker" uiAccess="false"/>
            </requestedPrivileges>
        </security>
    </trustInfo>
    ```

---

### Exercise 6: Hex Analysis

**Objective**: Perform a low-level examination of the binary to uncover hidden data or patterns.

#### Steps:
1. **Use HxD**: Open the malware sample in [HxD](https://mh-nexus.de/en/hxd/) or any hex editor.
2. **Analyze the Binary**:
   - Browse through the binary for recognizable patterns.
   - Look for obfuscated or encrypted strings.

#### Findings:
- The malware contains **obfuscated strings** and encrypted data, including references to DigiCert certificates:
  - `http://ocsp.digicert.com`
  - `DigiCert Trusted G4 Code Signing RSA4096 SHA384`
  - `http://crl3.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl`

---

## Conclusion

This static analysis provides an overview of the malware’s functionality based on its structure, imported functions, and embedded resources. The next phase will involve **dynamic analysis**, where we observe the malware’s behavior in a controlled environment.

